import{r as x,u as A,j as e}from"./react-vendor-DXKxfpO9.js";import{u as I}from"./useEmployees-CG4yn2Yf.js";import{d as f}from"./firebaseConfig-D3QKFph8.js";import{d as w,h as T,i as $}from"./firebase-DiQNaKJt.js";import{u as h,w as F,F as R,a as J}from"./vendor-h5GNKu5a.js";const Q=()=>{const{employees:j}=I(),[g,M]=x.useState(""),[v,O]=x.useState("asc"),[c,y]=x.useState(1),[d,C]=x.useState(""),m=10,b=A(),D=()=>b("/admin/addemployee"),E=s=>{C(s.target.value),y(1)},S=async s=>{window.confirm("Are you sure you want to delete this employee?")&&await $(w(f,"employees",s))},k=s=>b(`/admin/addemployee?employeeid=${s}`),L=()=>{const s=j.map(t=>({ID:t.employeeid,Name:`${t.firstName} ${t.lastName}`,Email:t.email,Phone:t.phone,Position:t.position,Department:t.department,JoinDate:t.joinDate,Role:t.role})),a=h.json_to_sheet(s),o=h.book_new();h.book_append_sheet(o,a,"Employees");const l=F(o,{bookType:"xlsx",type:"array"}),r=new Blob([l],{type:"application/octet-stream"});R.saveAs(r,"EmployeeList.xlsx")},P=async s=>{var i,p;const a=s.target.files[0];if(!a)return;const o=await a.arrayBuffer(),l=J(o),r=l.Sheets[l.SheetNames[0]],t=h.sheet_to_json(r);for(const n of t){const B=w(f,"employees",n.ID);await T(B,{employeeid:n.ID,firstName:((i=n.Name)==null?void 0:i.split(" ")[0])||"",lastName:((p=n.Name)==null?void 0:p.split(" ")[1])||"",email:n.Email,phone:n.Phone,position:n.Position,department:n.Department,joinDate:n.JoinDate,role:n.Role,createdAt:new Date().toISOString()})}alert("Bulk upload successful!")},u=j.filter(s=>{var o,l;const a=`${s.firstName} ${s.lastName}`.toLowerCase();return s.employeeid.toLowerCase().includes(d.toLowerCase())||a.includes(d.toLowerCase())||((o=s.position)==null?void 0:o.toLowerCase().includes(d.toLowerCase()))||((l=s.department)==null?void 0:l.toLowerCase().includes(d.toLowerCase()))}),_=[...u].sort((s,a)=>{var r,t,i,p;const o=((t=(r=s[g])==null?void 0:r.toLowerCase)==null?void 0:t.call(r))||"",l=((p=(i=a[g])==null?void 0:i.toLowerCase)==null?void 0:p.call(i))||"";return v==="asc"?o.localeCompare(l):l.localeCompare(o)}).slice((c-1)*m,c*m),N=Math.ceil(u.length/m);return e.jsx("div",{className:"container-fluid bg-gray-100 px-0",children:e.jsxs("div",{className:"bg-white p-3 rounded",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Employee List"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:L,className:"bg-green-500 text-white px-3 py-1 rounded",children:"Export"}),e.jsxs("label",{className:"bg-yellow-400 text-white px-3 py-1 rounded cursor-pointer",children:["Upload",e.jsx("input",{type:"file",accept:".xlsx,.csv",onChange:P,className:"hidden"})]}),e.jsx("button",{onClick:D,className:"bg-blue-500 text-white px-3 py-1 rounded",children:"+ Add"})]})]}),e.jsx("input",{type:"text",value:d,onChange:E,placeholder:"Search by name, ID, position or department",className:"w-full border px-4 py-2 rounded-lg mb-4 focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),u.length===0?e.jsx("p",{className:"text-gray-500",children:"No matching employees found."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"S.No."}),e.jsx("th",{className:"px-4 py-2",children:"ID"}),e.jsx("th",{className:"px-4 py-2",children:"Name"}),e.jsx("th",{className:"px-4 py-2",children:"Position"}),e.jsx("th",{className:"px-4 py-2",children:"Department"}),e.jsx("th",{className:"px-4 py-2",children:"Phone"}),e.jsx("th",{className:"px-4 py-2",children:"Join Date"}),e.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:_.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:(c-1)*m+a+1}),e.jsx("td",{className:"px-4 py-2",children:s.employeeid}),e.jsxs("td",{className:"px-4 py-2",children:[s.firstName," ",s.lastName]}),e.jsx("td",{className:"px-4 py-2",children:s.position}),e.jsx("td",{className:"px-4 py-2",children:s.department}),e.jsx("td",{className:"px-4 py-2",children:s.phone}),e.jsx("td",{className:"px-4 py-2",children:s.joinDate}),e.jsxs("td",{className:"px-4 py-2 space-x-2",children:[e.jsx("button",{onClick:()=>k(s.id),className:"text-blue-500",children:"Edit"}),e.jsx("button",{onClick:()=>S(s.id),className:"text-red-500",children:"Delete"})]})]},s.employeeid))})]}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Page ",c," of ",N]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:()=>y(s=>Math.max(s-1,1)),disabled:c===1,className:"px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200 disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>y(s=>Math.min(s+1,N)),disabled:c===N,className:"px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200 disabled:opacity-50",children:"Next"})]})]})]})]})})};export{Q as default};
